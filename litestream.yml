# Litestream configuration for SQLite replication to Cloudflare R2

# Database configuration
dbs:
  - path: /data/app.db
    replicas:
      - type: s3
        bucket: ${LITESTREAM_BUCKET}
        path: app.db
        endpoint: ${LITESTREAM_ENDPOINT}
        access-key-id: ${LITESTREAM_ACCESS_KEY_ID}
        secret-access-key: ${LITESTREAM_SECRET_ACCESS_KEY}
        region: auto
        
        # Retention policy: keep last 7 days of snapshots
        retention: 7d
        
        # Sync interval: replicate changes every 1 hour (to reduce R2 costs)
        # Each sync counts as 1 Class A operation ($4.50 per million)
        sync-interval: 1h
        
        # Checksums for data integrity
        checksum: true
        
        # WAL mode
        wal-mode: true
