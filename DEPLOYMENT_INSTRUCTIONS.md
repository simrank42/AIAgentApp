# üöÄ Quick Deployment Instructions for Render

## Your API Keys

All keys are configured in your `.env` file. Here's what you need to add to Render:

### 1. Create a GitHub Repository

```bash
cd backend
git init
git add .
git commit -m "Initial commit - Ready for Render deployment"
git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO.git
git branch -M main
git push -u origin main
```

### 2. Create R2 Bucket and Get Credentials

1. Go to [Cloudflare Dashboard](https://dash.cloudflare.com) ‚Üí R2
2. Create a new bucket named `aiagentapp`
3. Select region: **European Union (EU)** (or your preferred region)
4. Generate API Token:
   - Go to R2 ‚Üí Manage R2 API Tokens
   - Create API Token with read/write permissions
   - **Save these credentials securely** (you'll need them for Render):
     - Access Key ID
     - Secret Access Key
     - Endpoint URL (e.g., `https://your-account-id.r2.cloudflarestorage.com`)

**‚ö†Ô∏è IMPORTANT**: Never commit these credentials to your repository! They will be set in Render Dashboard only.

### 3. Deploy on Render

1. Go to https://dashboard.render.com
2. Click **New** ‚Üí **Web Service**
3. Connect your GitHub repository
4. Configure:
   - **Name**: `chat-backend`
   - **Branch**: `main`
   - **Runtime**: `Docker`

### 4. Add Environment Variables in Render

Click on your service ‚Üí **Environment** ‚Üí Add these variables:

```env
# Application
APP_ENV=prod

# Database
DATABASE_URL=sqlite:////data/app.db

# CORS (Update with your frontend URL)
CORS_ORIGINS=https://your-frontend-domain.com,http://localhost:4200

# Security
ENABLE_SECURITY_HEADERS=true
ENABLE_CORS=true
COOKIE_SECURE=true
COOKIE_SAMESITE=strict
ENABLE_RATE_LIMITING=true

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# AI - Hugging Face
AI_PROVIDER=huggingface
HF_TOKEN=your-huggingface-token-here
HF_MODEL=meta-llama/Llama-3.1-8B-Instruct

# Database Replication (R2)
LITESTREAM_ACCESS_KEY_ID=your-r2-access-key-here
LITESTREAM_SECRET_ACCESS_KEY=your-r2-secret-key-here
LITESTREAM_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
LITESTREAM_BUCKET=aiagentapp
```

**‚ö†Ô∏è CRITICAL SECURITY NOTE**: 
- Since Render free tier requires **public repositories**, you MUST set all secrets in the **Render Dashboard ‚Üí Environment Variables**, NOT in this documentation!
- Replace `your-huggingface-token-here` with your actual HuggingFace token
- Replace `your-r2-access-key-here` and `your-r2-secret-key-here` with your actual R2 credentials
- The `SECRET_KEY` will be auto-generated by Render - do NOT add it manually

**See [SECRET_MANAGEMENT_GUIDE.md](SECRET_MANAGEMENT_GUIDE.md) for detailed instructions on securely managing secrets.**

### 5. Advanced Settings

In **Advanced** section:
- **Health Check Path**: `/health`
- **Disk**: 
  - Name: `app-data`
  - Mount Path: `/data`
  - Size: `1 GB`

### 6. Deploy

Click **Create Web Service** and wait for build to complete (5-10 minutes).

## ‚úÖ Your Service Will Be Available At

```
https://chat-backend.onrender.com
```

## üîç Test Your Deployment

```bash
# Health check
curl https://chat-backend.onrender.com/health

# API docs
open https://chat-backend.onrender.com/docs
```

## üìù Important Notes

1. **Update CORS_ORIGINS** with your actual frontend URL when you deploy the frontend
2. **Never commit `.env`** file to git (it's in .gitignore)
3. **R2 Bucket must exist** before deploying - create it in Cloudflare dashboard
4. **First startup** may take 30 seconds (cold start on free tier)

## üÜò Troubleshooting

### Build fails?
- Check all environment variables are set
- Verify Dockerfile is correct

### Service crashes?
- Check logs in Render dashboard
- Verify R2 bucket exists and credentials are correct

### Database issues?
- Check Litestream logs
- Verify R2 credentials match your Cloudflare account

---

**That's it!** Your backend will auto-deploy on every git push to `main`.

For detailed instructions, see [DEPLOY_TO_RENDER.md](DEPLOY_TO_RENDER.md)

