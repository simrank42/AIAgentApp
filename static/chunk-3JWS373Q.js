import{a as T,b as c,c as A,d as N,f as G,g as j,h as B,i as D,j as z,k as R,m as $,n as O,o as H}from"./chunk-PA5TEUCC.js";import{$ as a,C as w,Ia as I,Ja as F,K as s,P as E,U as u,Ua as q,Va as L,Xa as M,aa as t,ab as Q,ba as r,ca as l,cb as V,d as h,fa as C,ga as P,ha as p,ma as f,na as d,oa as k,pa as g,u as y,v as S,w as x,x as m,y as b}from"./chunk-SDRE7JNM.js";function Z(i,o){if(i&1&&(t(0,"div",44),m(),t(1,"svg",45),l(2,"path",46),r(),d(3),r()),i&2){let n=p();s(3),g(" ",n.getFieldError("email")," ")}}function W(i,o){if(i&1&&(t(0,"option",47),d(1),r()),i&2){let n=o.$implicit;a("value",n.id),s(),g(" ",n.question," ")}}function J(i,o){i&1&&l(0,"div",48)}function K(i,o){i&1&&(m(),t(0,"svg",49),l(1,"path",50),r())}function X(i,o){if(i&1){let n=C();t(0,"div",51)(1,"span"),d(2),r(),t(3,"button",52),P("click",function(){S(n);let _=p();return x(_.retrySecurityQuestions())}),d(4," Retry "),r()()}if(i&2){let n=p();s(2),k(n.questionsError())}}function Y(i,o){i&1&&(t(0,"div",53),d(1," No security questions available. Please try again later. "),r())}function ee(i,o){if(i&1&&(t(0,"div",44),m(),t(1,"svg",45),l(2,"path",46),r(),d(3),r()),i&2){let n=p();s(3),g(" ",n.getFieldError("securityQuestionId")," ")}}function te(i,o){if(i&1&&(t(0,"div",44),m(),t(1,"svg",45),l(2,"path",46),r(),d(3),r()),i&2){let n=p();s(3),g(" ",n.getFieldError("securityAnswer")," ")}}function re(i,o){i&1&&(m(),t(0,"svg",49),l(1,"path",54)(2,"path",55),r())}function ie(i,o){i&1&&(m(),t(0,"svg",49),l(1,"path",56),r())}function ne(i,o){if(i&1&&(t(0,"div",44),m(),t(1,"svg",45),l(2,"path",46),r(),d(3),r()),i&2){let n=p();s(3),g(" ",n.getFieldError("newPassword")," ")}}function oe(i,o){i&1&&(m(),t(0,"svg",49),l(1,"path",54)(2,"path",55),r())}function se(i,o){i&1&&(m(),t(0,"svg",49),l(1,"path",56),r())}function ae(i,o){if(i&1&&(t(0,"div",44),m(),t(1,"svg",45),l(2,"path",46),r(),d(3),r()),i&2){let n=p();s(3),g(" ",n.getFieldError("confirmPassword")," ")}}function le(i,o){i&1&&l(0,"div",57)}function de(i,o){i&1&&(m(),t(0,"svg",58),l(1,"path",9),r())}var v=class v{constructor(){this.fb=y($);this.auth=y(V);this.toast=y(Q);this.router=y(q);this.fieldLabels={email:"Email address",securityQuestionId:"Security question",securityAnswer:"Security answer",newPassword:"New password",confirmPassword:"Confirm password"};this.isLoading=w(!1);this.showPassword=w(!1);this.showConfirmPassword=w(!1);this.securityQuestions=w([]);this.questionsLoading=w(!1);this.questionsError=w("");this.passwordMatchValidator=o=>{let n=o.get("newPassword"),e=o.get("confirmPassword");return n&&e&&n.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null};this.form=this.fb.group({email:["",[c.required,c.email]],securityQuestionId:["",[c.required]],securityAnswer:["",[c.required,c.maxLength(255)]],newPassword:["",[c.required,c.minLength(8),c.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/)]],confirmPassword:["",[c.required]]},{validators:this.passwordMatchValidator})}ngOnInit(){return h(this,null,function*(){yield this.loadSecurityQuestions()})}get email(){return this.form.get("email")}get securityQuestionId(){return this.form.get("securityQuestionId")}get securityAnswer(){return this.form.get("securityAnswer")}get newPassword(){return this.form.get("newPassword")}get confirmPassword(){return this.form.get("confirmPassword")}getFieldLabel(o){return this.fieldLabels[o]||o}getFieldError(o){let n=this.form.get(o);if(n?.errors&&(n.touched||n.dirty)){let e=this.getFieldLabel(o);if(n.errors.required)return`${e} is required`;if(n.errors.email)return"Please enter a valid email";if(n.errors.minlength)return`${e} must be at least ${n.errors.minlength.requiredLength} characters`;if(n.errors.pattern)return`${e} must contain at least one uppercase letter, one lowercase letter, one number, and one special character`;if(n.errors.passwordMismatch)return"Passwords do not match";if(n.errors.maxlength)return`${e} must be ${n.errors.maxlength.requiredLength} characters or fewer`}return""}togglePasswordVisibility(){this.showPassword.update(o=>!o)}toggleConfirmPasswordVisibility(){this.showConfirmPassword.update(o=>!o)}loadSecurityQuestions(){return h(this,null,function*(){this.questionsLoading.set(!0),this.questionsError.set("");try{let o=yield this.auth.getSecurityQuestions();o?.length||this.questionsError.set("Security questions are unavailable right now. Please try again later."),this.securityQuestions.set(o??[])}catch{this.questionsError.set("Unable to load security questions. Please try again."),this.toast.show("Failed to load security questions. Please try again.","error")}finally{this.questionsLoading.set(!1)}})}retrySecurityQuestions(){return h(this,null,function*(){yield this.loadSecurityQuestions()})}submit(){return h(this,null,function*(){if(this.form.invalid){this.form.markAllAsTouched(),this.toast.show("Please fix the errors below","error");return}try{this.isLoading.set(!0);let o={email:this.email?.value,security_question_id:Number(this.securityQuestionId?.value),security_answer:(this.securityAnswer?.value??"").trim(),new_password:this.newPassword?.value},e=(yield this.auth.resetPasswordWithSecurityQuestion(o))?.message||"Password reset successfully. Please sign in.";this.toast.show(e,"success"),this.router.navigateByUrl("/login")}catch{this.toast.show("Password reset failed. Please check your answers and try again.","error")}finally{this.isLoading.set(!1)}})}};v.\u0275fac=function(n){return new(n||v)},v.\u0275cmp=E({type:v,selectors:[["app-forgot-password"]],decls:81,vars:42,consts:[[1,"mx-auto","max-w-md","px-4","py-10"],[1,"absolute","inset-0","overflow-hidden","pointer-events-none"],[1,"absolute","top-1/4","left-1/4","w-96","h-96","bg-accent-500/8","rounded-full","blur-3xl","animate-float"],[1,"absolute","bottom-1/4","right-1/4","w-80","h-80","bg-purple-500/8","rounded-full","blur-3xl","animate-float",2,"animation-delay","1.5s"],[1,"absolute","top-1/2","left-1/3","w-72","h-72","bg-emerald-500/6","rounded-full","blur-3xl","animate-float",2,"animation-delay","3s"],[1,"relative","z-10"],[1,"text-center","mb-10"],[1,"inline-flex","items-center","justify-center","w-16","h-16","rounded-full","bg-gradient-to-br","from-amber-500/20","to-purple-500/20","mb-6","animate-pulse-glow"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-amber-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 11c0 1.1-.9 2-2 2m4 0a2 2 0 10-4 0m6 7H8a4 4 0 01-4-4V7a4 4 0 014-4h8a4 4 0 014 4v9a4 4 0 01-4 4z"],[1,"text-4xl","font-bold","text-gradient","mb-3","tracking-tight"],[1,"text-neutral-400","text-lg"],[1,"card-premium","p-10","animate-scale-in"],[1,"space-y-7",3,"ngSubmit","formGroup"],[1,"block","text-sm","font-medium","text-neutral-300","mb-2"],[1,"relative"],["type","email","formControlName","email","placeholder","Enter your account email",1,"input","w-full","pr-10"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-neutral-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"],["class","mt-1 text-sm text-red-400 flex items-center gap-1",4,"ngIf"],["formControlName","securityQuestionId",1,"input","w-full","appearance-none","pr-12","text-neutral-200","bg-ink-800/60","border","border-white/10","rounded-xl","focus:border-accent-400","focus:ring-2","focus:ring-accent-500/40","transition-all",2,"color-scheme","dark","background-color","rgba(15, 20, 26, 0.65)","backdrop-filter","blur(12px)",3,"disabled"],["value","","disabled","","selected","",1,"bg-ink-900","text-neutral-400"],["class","bg-ink-900 text-neutral-200 hover:bg-ink-700 cursor-pointer","style","padding: 12px; font-size: 0.95rem;",3,"value",4,"ngFor","ngForOf"],[1,"absolute","right-3","top-1/2","-translate-y-1/2","flex","items-center","gap-2","text-neutral-400","pointer-events-none"],["class","w-4 h-4 border-2 border-accent-300 border-t-transparent rounded-full animate-spin",4,"ngIf"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","mt-2 flex items-center justify-between text-sm text-amber-300 bg-amber-500/10 border border-amber-500/30 rounded-lg px-3 py-2",4,"ngIf"],["class","mt-2 text-sm text-neutral-400",4,"ngIf"],["type","text","formControlName","securityAnswer","placeholder","Enter the answer on file",1,"input","w-full","pr-10"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6l3 3"],["formControlName","newPassword","placeholder","Create a new password",1,"input","w-full","pr-12",3,"type"],["type","button",1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-neutral-400","hover:text-accent-300","transition-colors",3,"click"],["formControlName","confirmPassword","placeholder","Confirm your new password",1,"input","w-full","pr-12",3,"type"],["type","submit",1,"btn","btn-primary","w-full","py-4","text-lg","font-semibold","shadow-2xl","hover:shadow-glow-purple","transform","hover:-translate-y-0.5","disabled:transform-none",3,"disabled"],["class","w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2",4,"ngIf"],["class","w-5 h-5 mr-2","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"mt-8","pt-7","border-t","border-white/10"],[1,"text-center","space-y-3"],["routerLink","/login",1,"inline-flex","items-center","gap-2","text-accent-400","hover:text-accent-300","transition-all","font-semibold","group"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","transform","group-hover:-translate-x-1","transition-transform"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 17l-5-5m0 0l5-5m-5 5h12"],[1,"text-sm","text-neutral-400"],["routerLink","/register",1,"text-accent-400","hover:text-accent-200","font-semibold"],[1,"mt-1","text-sm","text-red-400","flex","items-center","gap-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-ink-900","text-neutral-200","hover:bg-ink-700","cursor-pointer",2,"padding","12px","font-size","0.95rem",3,"value"],[1,"w-4","h-4","border-2","border-accent-300","border-t-transparent","rounded-full","animate-spin"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"mt-2","flex","items-center","justify-between","text-sm","text-amber-300","bg-amber-500/10","border","border-amber-500/30","rounded-lg","px-3","py-2"],["type","button",1,"text-accent-300","hover:text-accent-100","font-semibold",3,"click"],[1,"mt-2","text-sm","text-neutral-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"],[1,"w-5","h-5","border-2","border-white","border-t-transparent","rounded-full","animate-spin","mr-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"]],template:function(n,e){n&1&&(t(0,"div",0)(1,"div",1),l(2,"div",2)(3,"div",3)(4,"div",4),r(),t(5,"div",5)(6,"div",6)(7,"div",7),m(),t(8,"svg",8),l(9,"path",9),r()(),b(),t(10,"h1",10),d(11,"Reset Password"),r(),t(12,"p",11),d(13,"Verify your security question to set a new password"),r()(),t(14,"div",12)(15,"form",13),P("ngSubmit",function(){return e.submit()}),t(16,"div")(17,"label",14),d(18," Email Address "),r(),t(19,"div",15),l(20,"input",16),t(21,"div",17),m(),t(22,"svg",18),l(23,"path",19),r()()(),u(24,Z,4,1,"div",20),r(),b(),t(25,"div")(26,"label",14),d(27," Security Question "),r(),t(28,"div",15)(29,"select",21)(30,"option",22),d(31," Select your security question "),r(),u(32,W,2,2,"option",23),r(),t(33,"div",24),u(34,J,1,0,"div",25)(35,K,2,0,"svg",26),r()(),u(36,X,5,1,"div",27)(37,Y,2,0,"div",28)(38,ee,4,1,"div",20),r(),t(39,"div")(40,"label",14),d(41," Security Answer "),r(),t(42,"div",15),l(43,"input",29),t(44,"div",17),m(),t(45,"svg",18),l(46,"path",30),r()()(),u(47,te,4,1,"div",20),r(),b(),t(48,"div")(49,"label",14),d(50," New Password "),r(),t(51,"div",15),l(52,"input",31),t(53,"button",32),P("click",function(){return e.togglePasswordVisibility()}),u(54,re,3,0,"svg",26)(55,ie,2,0,"svg",26),r()(),u(56,ne,4,1,"div",20),r(),t(57,"div")(58,"label",14),d(59," Confirm New Password "),r(),t(60,"div",15),l(61,"input",33),t(62,"button",32),P("click",function(){return e.toggleConfirmPasswordVisibility()}),u(63,oe,3,0,"svg",26)(64,se,2,0,"svg",26),r()(),u(65,ae,4,1,"div",20),r(),t(66,"button",34),u(67,le,1,0,"div",35)(68,de,2,0,"svg",36),d(69),r()(),t(70,"div",37)(71,"div",38)(72,"a",39),m(),t(73,"svg",40),l(74,"path",41),r(),b(),t(75,"span"),d(76,"Back to Sign In"),r()(),t(77,"p",42),d(78,"Need an account? "),t(79,"a",43),d(80,"Create one"),r()()()()()()()),n&2&&(s(15),a("formGroup",e.form),s(5),f("border-red-500",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched))("border-accent-500",(e.email==null?null:e.email.valid)&&(e.email==null?null:e.email.touched)),s(4),a("ngIf",e.getFieldError("email")),s(5),f("border-red-500",(e.securityQuestionId==null?null:e.securityQuestionId.invalid)&&(e.securityQuestionId==null?null:e.securityQuestionId.touched))("border-accent-500",(e.securityQuestionId==null?null:e.securityQuestionId.valid)&&(e.securityQuestionId==null?null:e.securityQuestionId.touched)),a("disabled",e.questionsLoading()||!e.securityQuestions().length),s(3),a("ngForOf",e.securityQuestions()),s(2),a("ngIf",e.questionsLoading()),s(),a("ngIf",!e.questionsLoading()),s(),a("ngIf",e.questionsError()),s(),a("ngIf",!e.questionsError()&&!e.securityQuestions().length&&!e.questionsLoading()),s(),a("ngIf",e.getFieldError("securityQuestionId")),s(5),f("border-red-500",(e.securityAnswer==null?null:e.securityAnswer.invalid)&&(e.securityAnswer==null?null:e.securityAnswer.touched))("border-accent-500",(e.securityAnswer==null?null:e.securityAnswer.valid)&&(e.securityAnswer==null?null:e.securityAnswer.touched)),s(4),a("ngIf",e.getFieldError("securityAnswer")),s(5),f("border-red-500",(e.newPassword==null?null:e.newPassword.invalid)&&(e.newPassword==null?null:e.newPassword.touched))("border-accent-500",(e.newPassword==null?null:e.newPassword.valid)&&(e.newPassword==null?null:e.newPassword.touched)),a("type",e.showPassword()?"text":"password"),s(2),a("ngIf",!e.showPassword()),s(),a("ngIf",e.showPassword()),s(),a("ngIf",e.getFieldError("newPassword")),s(5),f("border-red-500",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&(e.confirmPassword==null?null:e.confirmPassword.touched))("border-accent-500",(e.confirmPassword==null?null:e.confirmPassword.valid)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),a("type",e.showConfirmPassword()?"text":"password"),s(2),a("ngIf",!e.showConfirmPassword()),s(),a("ngIf",e.showConfirmPassword()),s(),a("ngIf",e.getFieldError("confirmPassword")),s(),a("disabled",e.isLoading()||e.form.invalid),s(),a("ngIf",e.isLoading()),s(),a("ngIf",!e.isLoading()),s(),g(" ",e.isLoading()?"Resetting Password...":"Reset Password"," "))},dependencies:[O,G,z,R,T,D,A,N,H,j,B,F,I,M,L],encapsulation:2});var U=v;export{U as ForgotPasswordComponent};
